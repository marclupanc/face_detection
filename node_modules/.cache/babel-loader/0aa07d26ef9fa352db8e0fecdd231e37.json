{"ast":null,"code":"import * as tf from '@tensorflow/tfjs-core';\n/**\r\n * Pads the smaller dimension of an image tensor with zeros, such that width === height.\r\n *\r\n * @param imgTensor The image tensor.\r\n * @param isCenterImage (optional, default: false) If true, add an equal amount of padding on\r\n * both sides of the minor dimension oof the image.\r\n * @returns The padded tensor with width === height.\r\n */\n\nexport function padToSquare(imgTensor, isCenterImage) {\n  if (isCenterImage === void 0) {\n    isCenterImage = false;\n  }\n\n  return tf.tidy(function () {\n    var _a = imgTensor.shape.slice(1),\n        height = _a[0],\n        width = _a[1];\n\n    if (height === width) {\n      return imgTensor;\n    }\n\n    var dimDiff = Math.abs(height - width);\n    var paddingAmount = Math.round(dimDiff * (isCenterImage ? 0.5 : 1));\n    var paddingAxis = height > width ? 2 : 1;\n\n    var createPaddingTensor = function (paddingAmount) {\n      var paddingTensorShape = imgTensor.shape.slice();\n      paddingTensorShape[paddingAxis] = paddingAmount;\n      return tf.fill(paddingTensorShape, 0);\n    };\n\n    var paddingTensorAppend = createPaddingTensor(paddingAmount);\n    var remainingPaddingAmount = dimDiff - paddingTensorAppend.shape[paddingAxis];\n    var paddingTensorPrepend = isCenterImage && remainingPaddingAmount ? createPaddingTensor(remainingPaddingAmount) : null;\n    var tensorsToStack = [paddingTensorPrepend, imgTensor, paddingTensorAppend].filter(function (t) {\n      return !!t;\n    }).map(function (t) {\n      return t.toFloat();\n    });\n    return tf.concat(tensorsToStack, paddingAxis);\n  });\n}","map":{"version":3,"mappings":"AAAA,OAAO,KAAKA,EAAZ,MAAoB,uBAApB;AAEA;;;;;;;;;AAQA,OAAM,SAAUC,WAAV,CACJC,SADI,EAEJC,aAFI,EAE0B;EAA9B;IAAAA;EAA8B;;EAE9B,OAAOH,EAAE,CAACI,IAAH,CAAQ;IAEP;IAAA,IAACC,cAAD;IAAA,IAASC,aAAT;;IACN,IAAID,MAAM,KAAKC,KAAf,EAAsB;MACpB,OAAOJ,SAAP;IACD;;IAED,IAAMK,OAAO,GAAGC,IAAI,CAACC,GAAL,CAASJ,MAAM,GAAGC,KAAlB,CAAhB;IACA,IAAMI,aAAa,GAAGF,IAAI,CAACG,KAAL,CAAWJ,OAAO,IAAIJ,aAAa,GAAG,GAAH,GAAS,CAA1B,CAAlB,CAAtB;IACA,IAAMS,WAAW,GAAGP,MAAM,GAAGC,KAAT,GAAiB,CAAjB,GAAqB,CAAzC;;IAEA,IAAMO,mBAAmB,GAAG,UAACH,aAAD,EAAsB;MAChD,IAAMI,kBAAkB,GAAGZ,SAAS,CAACa,KAAV,CAAgBC,KAAhB,EAA3B;MACAF,kBAAkB,CAACF,WAAD,CAAlB,GAAkCF,aAAlC;MACA,OAAOV,EAAE,CAACiB,IAAH,CAAQH,kBAAR,EAA4B,CAA5B,CAAP;IACD,CAJD;;IAMA,IAAMI,mBAAmB,GAAGL,mBAAmB,CAACH,aAAD,CAA/C;IACA,IAAMS,sBAAsB,GAAGZ,OAAO,GAAIW,mBAAmB,CAACH,KAApB,CAA0BH,WAA1B,CAA1C;IAEA,IAAMQ,oBAAoB,GAAGjB,aAAa,IAAIgB,sBAAjB,GACzBN,mBAAmB,CAACM,sBAAD,CADM,GAEzB,IAFJ;IAIA,IAAME,cAAc,GAAG,CACrBD,oBADqB,EAErBlB,SAFqB,EAGrBgB,mBAHqB,EAKpBI,MALoB,CAKb,aAAC;MAAI,QAAC,CAACC,CAAF;IAAG,CALK,EAMpBC,GANoB,CAMhB,UAACD,CAAD,EAAa;MAAK,QAAC,CAACE,OAAF;IAAW,CANb,CAAvB;IAOA,OAAOzB,EAAE,CAAC0B,MAAH,CAAUL,cAAV,EAA0BT,WAA1B,CAAP;EACD,CAhCM,CAAP;AAiCD","names":["tf","padToSquare","imgTensor","isCenterImage","tidy","height","width","dimDiff","Math","abs","paddingAmount","round","paddingAxis","createPaddingTensor","paddingTensorShape","shape","slice","fill","paddingTensorAppend","remainingPaddingAmount","paddingTensorPrepend","tensorsToStack","filter","t","map","toFloat","concat"],"sources":["../../../src/ops/padToSquare.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}