{"ast":null,"code":"import { createBrowserEnv } from './createBrowserEnv';\nimport { createFileSystem } from './createFileSystem';\nimport { createNodejsEnv } from './createNodejsEnv';\nimport { isBrowser } from './isBrowser';\nimport { isNodejs } from './isNodejs';\nvar environment;\n\nfunction getEnv() {\n  if (!environment) {\n    throw new Error('getEnv - environment is not defined, check isNodejs() and isBrowser()');\n  }\n\n  return environment;\n}\n\nfunction setEnv(env) {\n  environment = env;\n}\n\nfunction initialize() {\n  // check for isBrowser() first to prevent electron renderer process\n  // to be initialized with wrong environment due to isNodejs() returning true\n  if (isBrowser()) {\n    setEnv(createBrowserEnv());\n  }\n\n  if (isNodejs()) {\n    setEnv(createNodejsEnv());\n  }\n}\n\nfunction monkeyPatch(env) {\n  if (!environment) {\n    initialize();\n  }\n\n  if (!environment) {\n    throw new Error('monkeyPatch - environment is not defined, check isNodejs() and isBrowser()');\n  }\n\n  var _a = env.Canvas,\n      Canvas = _a === void 0 ? environment.Canvas : _a,\n      _b = env.Image,\n      Image = _b === void 0 ? environment.Image : _b;\n  environment.Canvas = Canvas;\n  environment.Image = Image;\n\n  environment.createCanvasElement = env.createCanvasElement || function () {\n    return new Canvas();\n  };\n\n  environment.createImageElement = env.createImageElement || function () {\n    return new Image();\n  };\n\n  environment.ImageData = env.ImageData || environment.ImageData;\n  environment.Video = env.Video || environment.Video;\n  environment.fetch = env.fetch || environment.fetch;\n  environment.readFile = env.readFile || environment.readFile;\n}\n\nexport var env = {\n  getEnv: getEnv,\n  setEnv: setEnv,\n  initialize: initialize,\n  createBrowserEnv: createBrowserEnv,\n  createFileSystem: createFileSystem,\n  createNodejsEnv: createNodejsEnv,\n  monkeyPatch: monkeyPatch,\n  isBrowser: isBrowser,\n  isNodejs: isNodejs\n};\ninitialize();","map":{"version":3,"mappings":"AAAA,SAASA,gBAAT,QAAiC,oBAAjC;AACA,SAASC,gBAAT,QAAiC,oBAAjC;AACA,SAASC,eAAT,QAAgC,mBAAhC;AACA,SAASC,SAAT,QAA0B,aAA1B;AACA,SAASC,QAAT,QAAyB,YAAzB;AAGA,IAAIC,WAAJ;;AAEA,SAASC,MAAT,GAAe;EACb,IAAI,CAACD,WAAL,EAAkB;IAChB,MAAM,IAAIE,KAAJ,CAAU,uEAAV,CAAN;EACD;;EACD,OAAOF,WAAP;AACD;;AAED,SAASG,MAAT,CAAgBC,GAAhB,EAAgC;EAC9BJ,WAAW,GAAGI,GAAd;AACD;;AAED,SAASC,UAAT,GAAmB;EACjB;EACA;EACA,IAAIP,SAAS,EAAb,EAAiB;IACfK,MAAM,CAACR,gBAAgB,EAAjB,CAAN;EACD;;EACD,IAAII,QAAQ,EAAZ,EAAgB;IACdI,MAAM,CAACN,eAAe,EAAhB,CAAN;EACD;AACF;;AAED,SAASS,WAAT,CAAqBF,GAArB,EAA8C;EAC5C,IAAI,CAACJ,WAAL,EAAkB;IAChBK,UAAU;EACX;;EAED,IAAI,CAACL,WAAL,EAAkB;IAChB,MAAM,IAAIE,KAAJ,CAAU,4EAAV,CAAN;EACD;;EAEO;EAAA;EAAA,IAA6BK,cAA7B;EAAA,IAA6BC,8CAA7B;EACRR,WAAW,CAACS,MAAZ,GAAqBA,MAArB;EACAT,WAAW,CAACQ,KAAZ,GAAoBA,KAApB;;EACAR,WAAW,CAACU,mBAAZ,GAAkCN,GAAG,CAACM,mBAAJ,IAA4B;IAAM,WAAID,MAAJ;EAAY,CAAhF;;EACAT,WAAW,CAACW,kBAAZ,GAAiCP,GAAG,CAACO,kBAAJ,IAA2B;IAAM,WAAIH,KAAJ;EAAW,CAA7E;;EAEAR,WAAW,CAACY,SAAZ,GAAwBR,GAAG,CAACQ,SAAJ,IAAiBZ,WAAW,CAACY,SAArD;EACAZ,WAAW,CAACa,KAAZ,GAAoBT,GAAG,CAACS,KAAJ,IAAab,WAAW,CAACa,KAA7C;EACAb,WAAW,CAACc,KAAZ,GAAoBV,GAAG,CAACU,KAAJ,IAAad,WAAW,CAACc,KAA7C;EACAd,WAAW,CAACe,QAAZ,GAAuBX,GAAG,CAACW,QAAJ,IAAgBf,WAAW,CAACe,QAAnD;AACD;;AAED,OAAO,IAAMX,GAAG,GAAG;EACjBH,MAAM,QADW;EAEjBE,MAAM,QAFW;EAGjBE,UAAU,YAHO;EAIjBV,gBAAgB,kBAJC;EAKjBC,gBAAgB,kBALC;EAMjBC,eAAe,iBANE;EAOjBS,WAAW,aAPM;EAQjBR,SAAS,WARQ;EASjBC,QAAQ;AATS,CAAZ;AAYPM,UAAU","names":["createBrowserEnv","createFileSystem","createNodejsEnv","isBrowser","isNodejs","environment","getEnv","Error","setEnv","env","initialize","monkeyPatch","_b","Image","Canvas","createCanvasElement","createImageElement","ImageData","Video","fetch","readFile"],"sources":["../../../src/env/index.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}