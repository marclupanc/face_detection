{"ast":null,"code":"var _jsxFileName = \"/Users/maraclupanciuc/Desktop/SmartBrain/face-detection/face_detection/src/components/Stream/Stream.jsx\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport './stream.css';\nimport * as faceapi from 'face-api.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction Stream() {\n  _s();\n\n  const [modelsLoaded, setModelsLoaded] = React.useState(false);\n  const [captureVideo, setCaptureVideo] = React.useState(false);\n  const videoRef = React.useRef();\n  const videoHeight = 480;\n  const videoWidth = 640;\n  const canvasRef = React.useRef();\n  React.useEffect(() => {\n    const loadModels = async () => {\n      const MODEL_URL = process.env.PUBLIC_URL + '../../../public/models';\n      Promise.all([faceapi.nets.tinyFaceDetector.loadFromUri(MODEL_URL), faceapi.nets.faceLandmark68Net.loadFromUri(MODEL_URL), faceapi.nets.faceRecognitionNet.loadFromUri(MODEL_URL), faceapi.nets.faceExpressionNet.loadFromUri(MODEL_URL)]).then(setModelsLoaded(true)).then(console.log(faceapi.nets.tinyFaceDetector));\n    };\n\n    loadModels();\n  }, []);\n\n  const startVideo = () => {\n    setCaptureVideo(true);\n    navigator.mediaDevices.getUserMedia({\n      video: {\n        width: 300\n      }\n    }).then(stream => {\n      let video = videoRef.current;\n      video.srcObject = stream;\n      video.play();\n    }).catch(err => {\n      console.error(\"error:\", err);\n    });\n  };\n\n  const handleVideoOnPlay = () => {\n    setInterval(async () => {\n      if (canvasRef && canvasRef.current) {\n        canvasRef.current.innerHTML = faceapi.createCanvasFromMedia(videoRef.current);\n        const displaySize = {\n          width: videoWidth,\n          height: videoHeight\n        };\n        faceapi.matchDimensions(canvasRef.current, displaySize);\n        const detections = await faceapi.detectAllFaces(videoRef.current, new faceapi.TinyFaceDetectorOptions()).withFaceLandmarks().withFaceExpressions();\n        const resizedDetections = faceapi.resizeResults(detections, displaySize);\n        canvasRef && canvasRef.current && canvasRef.current.getContext('2d').clearRect(0, 0, videoWidth, videoHeight);\n        canvasRef && canvasRef.current && faceapi.draw.drawDetections(canvasRef.current, resizedDetections);\n        canvasRef && canvasRef.current && faceapi.draw.drawFaceLandmarks(canvasRef.current, resizedDetections);\n        canvasRef && canvasRef.current && faceapi.draw.drawFaceExpressions(canvasRef.current, resizedDetections);\n      }\n    }, 100);\n  };\n\n  const closeWebcam = () => {\n    videoRef.current.pause();\n    videoRef.current.srcObject.getTracks()[0].stop();\n    setCaptureVideo(false);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"open-close\",\n      children: captureVideo && modelsLoaded ? /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn\",\n        onClick: closeWebcam,\n        children: \"Close Webcam\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn\",\n        onClick: startVideo,\n        children: \"Open Webcam\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, this), captureVideo ? modelsLoaded ? /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          justifyContent: 'center',\n          padding: '10px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"video\", {\n          ref: videoRef,\n          height: videoHeight,\n          width: videoWidth,\n          onPlay: handleVideoOnPlay,\n          style: {\n            borderRadius: '10px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n          ref: canvasRef,\n          style: {\n            position: 'absolute'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 15\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 13\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 13\n    }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 76,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Stream, \"r7/G1Z43y30xxZApC/YFouB9GI0=\");\n\n_c = Stream;\nexport default Stream; // import {useRef, useEffect, useState} from \"react\";\n// import './stream.css'\n// import * as faceapi from 'face-api.js';import '../../face-api.min'\n// // import {faceapi} from \"../../face-api.min\";\n//\n//\n// const Stream = ({videoState, setVideoState}) => {\n//\n//   const videoRef = useRef();\n//   const [modelsLoaded, setModelsLoaded] = useState(false);\n//   const [captureVideo, setCaptureVideo] = useState(false);\n//\n//   useEffect(() => {\n//     const loadModels = async () => {\n//       const MODEL_URL = process.env.PUBLIC_URL + '../../models';\n//\n//       Promise.all([\n//         faceapi.nets.tinyFaceDetector.loadFromUri(MODEL_URL),\n//         faceapi.nets.faceLandmark68Net.loadFromUri(MODEL_URL),\n//         faceapi.nets.faceRecognitionNet.loadFromUri(MODEL_URL),\n//         faceapi.nets.faceExpressionNet.loadFromUri(MODEL_URL),\n//       ]).then(setModelsLoaded(true));\n//     }\n//     loadModels();\n//   }, []);\n//   return (\n//     <div>\n//\n//     </div>\n//   )\n// }\n// //   useEffect(() => {\n// //     navigator.mediaDevices.getUserMedia({ video: videoState }).then((stream) => {\n// //       videoRef.current.srcObject = stream;\n// //     });\n// //   }, [videoState]);\n// //\n// //   return (\n// //     <div>\n// //       <button onClick={setVideoState}>CLICK</button>\n// //       <div className=\"video-box center\">\n// //         <video ref={videoRef} autoPlay/>\n// //       </div>\n// //     </div>\n// //   );\n// // }\n//\n// export default Stream;\n//\n//\n\nvar _c;\n\n$RefreshReg$(_c, \"Stream\");","map":{"version":3,"names":["React","faceapi","Stream","modelsLoaded","setModelsLoaded","useState","captureVideo","setCaptureVideo","videoRef","useRef","videoHeight","videoWidth","canvasRef","useEffect","loadModels","MODEL_URL","process","env","PUBLIC_URL","Promise","all","nets","tinyFaceDetector","loadFromUri","faceLandmark68Net","faceRecognitionNet","faceExpressionNet","then","console","log","startVideo","navigator","mediaDevices","getUserMedia","video","width","stream","current","srcObject","play","catch","err","error","handleVideoOnPlay","setInterval","innerHTML","createCanvasFromMedia","displaySize","height","matchDimensions","detections","detectAllFaces","TinyFaceDetectorOptions","withFaceLandmarks","withFaceExpressions","resizedDetections","resizeResults","getContext","clearRect","draw","drawDetections","drawFaceLandmarks","drawFaceExpressions","closeWebcam","pause","getTracks","stop","display","justifyContent","padding","borderRadius","position"],"sources":["/Users/maraclupanciuc/Desktop/SmartBrain/face-detection/face_detection/src/components/Stream/Stream.jsx"],"sourcesContent":["import React from 'react';\n\nimport './stream.css'\n\nimport * as faceapi from 'face-api.js';\n\n\nfunction Stream() {\n\n  const [modelsLoaded, setModelsLoaded] = React.useState(false);\n  const [captureVideo, setCaptureVideo] = React.useState(false);\n\n  const videoRef = React.useRef();\n  const videoHeight = 480;\n  const videoWidth = 640;\n  const canvasRef = React.useRef();\n\n  React.useEffect(() => {\n    const loadModels = async () => {\n      const MODEL_URL = process.env.PUBLIC_URL + '../../../public/models';\n\n\n      Promise.all([\n        faceapi.nets.tinyFaceDetector.loadFromUri(MODEL_URL),\n        faceapi.nets.faceLandmark68Net.loadFromUri(MODEL_URL),\n        faceapi.nets.faceRecognitionNet.loadFromUri(MODEL_URL),\n        faceapi.nets.faceExpressionNet.loadFromUri(MODEL_URL),\n      ]).then(setModelsLoaded(true)).then(console.log(faceapi.nets.tinyFaceDetector))\n    }\n    loadModels();\n  }, []);\n\n  const startVideo = () => {\n    setCaptureVideo(true);\n    navigator.mediaDevices\n      .getUserMedia({ video: { width: 300 } })\n      .then(stream => {\n        let video = videoRef.current;\n        video.srcObject = stream;\n        video.play();\n      })\n      .catch(err => {\n        console.error(\"error:\", err);\n      });\n  }\n\n  const handleVideoOnPlay = () => {\n    setInterval(async () => {\n      if (canvasRef && canvasRef.current) {\n        canvasRef.current.innerHTML = faceapi.createCanvasFromMedia(videoRef.current);\n        const displaySize = {\n          width: videoWidth,\n          height: videoHeight\n        }\n\n        faceapi.matchDimensions(canvasRef.current, displaySize);\n\n        const detections = await faceapi.detectAllFaces(videoRef.current, new faceapi.TinyFaceDetectorOptions()).withFaceLandmarks().withFaceExpressions();\n\n        const resizedDetections = faceapi.resizeResults(detections, displaySize);\n\n        canvasRef && canvasRef.current && canvasRef.current.getContext('2d').clearRect(0, 0, videoWidth, videoHeight);\n        canvasRef && canvasRef.current && faceapi.draw.drawDetections(canvasRef.current, resizedDetections);\n        canvasRef && canvasRef.current && faceapi.draw.drawFaceLandmarks(canvasRef.current, resizedDetections);\n        canvasRef && canvasRef.current && faceapi.draw.drawFaceExpressions(canvasRef.current, resizedDetections);\n      }\n    }, 100)\n  }\n  const closeWebcam = () => {\n    videoRef.current.pause();\n    videoRef.current.srcObject.getTracks()[0].stop();\n    setCaptureVideo(false);\n  }\n\n  return (\n    <div>\n      <div className='open-close'>\n        {\n          captureVideo && modelsLoaded ?\n            <button className='btn' onClick={closeWebcam}>\n              Close Webcam\n            </button>\n            :\n            <button className='btn' onClick={startVideo}>\n              Open Webcam\n            </button>\n        }\n      </div>\n      {\n        captureVideo ?\n          modelsLoaded ?\n            <div>\n              <div style={{ display: 'flex', justifyContent: 'center', padding: '10px' }}>\n                <video ref={videoRef} height={videoHeight} width={videoWidth} onPlay={handleVideoOnPlay} style={{ borderRadius: '10px' }} />\n                <canvas ref={canvasRef} style={{ position: 'absolute' }} />\n              </div>\n            </div>\n            :\n            <div>loading...</div>\n          :\n          <>\n          </>\n      }\n    </div>\n  );\n}\nexport default Stream;\n// import {useRef, useEffect, useState} from \"react\";\n// import './stream.css'\n// import * as faceapi from 'face-api.js';import '../../face-api.min'\n// // import {faceapi} from \"../../face-api.min\";\n//\n//\n// const Stream = ({videoState, setVideoState}) => {\n//\n//   const videoRef = useRef();\n//   const [modelsLoaded, setModelsLoaded] = useState(false);\n//   const [captureVideo, setCaptureVideo] = useState(false);\n//\n//   useEffect(() => {\n//     const loadModels = async () => {\n//       const MODEL_URL = process.env.PUBLIC_URL + '../../models';\n//\n//       Promise.all([\n//         faceapi.nets.tinyFaceDetector.loadFromUri(MODEL_URL),\n//         faceapi.nets.faceLandmark68Net.loadFromUri(MODEL_URL),\n//         faceapi.nets.faceRecognitionNet.loadFromUri(MODEL_URL),\n//         faceapi.nets.faceExpressionNet.loadFromUri(MODEL_URL),\n//       ]).then(setModelsLoaded(true));\n//     }\n//     loadModels();\n//   }, []);\n//   return (\n//     <div>\n//\n//     </div>\n//   )\n// }\n// //   useEffect(() => {\n// //     navigator.mediaDevices.getUserMedia({ video: videoState }).then((stream) => {\n// //       videoRef.current.srcObject = stream;\n// //     });\n// //   }, [videoState]);\n// //\n// //   return (\n// //     <div>\n// //       <button onClick={setVideoState}>CLICK</button>\n// //       <div className=\"video-box center\">\n// //         <video ref={videoRef} autoPlay/>\n// //       </div>\n// //     </div>\n// //   );\n// // }\n//\n// export default Stream;\n//\n//\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}